(function(a){var b=[],c;if(c="undefined"!==typeof XDomainRequest){try{var d="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){d=!1}c=!d}c&&a.ajaxTransport("+*",function(c,d,g){var e,f;if(c.async&&c.crossDomain){var k=function(){f=!0;if(e){var c=a.inArray(e,b);0<=c&&b.splice(c,1);e.onload=null;e.onerror=null;e.ontimeout=null;e.onprogress=null}};return{send:function(a,d){var g=c.xdrTimeout||6E4;e=new XDomainRequest;e.timeout=g;e.open(c.type,c.url);e.onload=function(){f||
(k(),d(200,"OK","string"===typeof e.responseText?{text:e.responseText}:void 0,"Content-Type: "+e.contentType))};e.onerror=function(){f||(k(),d(500,"XDomainRequest Error"))};e.ontimeout=function(){f||(k(),d(500,"XDomainRequest Timeout"))};e.onprogress=function(){};e.send(c.hasContent&&c.data||null);b.push(e)},abort:function(){e&&!f&&(k(),e.abort())}}}})})(jQuery);
function postCCDetailstoBG(a,b,c,d,e,f,g,h,l,k,p,m,q){var n=validateInputs(a,b,c,d,e,f,g,h,l,k,p);return n.valid?(b=do_encrypt(b,c,k),null!=b?(a="?security_token="+a+"&exp_month="+d+"&exp_year="+e+"&appName="+f+"&zip="+encodeURIComponent(g)+"&cc_fname="+encodeURIComponent(h)+"&cc_lname="+encodeURIComponent(l)+"&encrypted_ccdata="+encodeURIComponent(b),jQuery.ajax({url:p+a,type:"POST",contentType:"text/plain",dataType:"text",crossDomain:!0,async:!0,success:m,error:q}),{rtn_code:"BG-0",rtn_msg:"AJAX Request has been Submitted successfully."}):
{rtn_code:"BG-1065",rtn_msg:"AJAX Request hasn't been Submitted,Encryption Failed In UI JS library, please check 'key' value."}):{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted,Invalid Inputs Caught in UI JS library, please check input '"+n.statusMsg+"' value."}}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.nullToString=function(){return void 0===this||"undefined"==this||null==this||"null"==this?"":this};
function postPanDataToBG(a,b,c,d,e){function f(){if("CC"!=b.pan_type&&"ECHECK"!=b.pan_type&&"DD"!=b.pan_type)return{isValid:!1,statusMsg:"pan_object.pan_type"};if("CC"==b.pan_type){if(!/^[exEX]{2}[a-zA-Z0-9]{10}[0-9]{4}$/.test(b.cc_no)){if(0==b.cc_no.length||19<b.cc_no.length||isNaN(b.cc_no))return{isValid:!1,statusMsg:"pan_object.cc_no not a valid CCNo or PCI Token"};if(3>b.cvv.length||4<b.cvv.length||isNaN(b.cvv))return{isValid:!1,statusMsg:"pan_object.cvv"}}if(0>=b.cc_exp_month||12<b.cc_exp_month||
isNaN(b.cc_exp_month))return{isValid:!1,statusMsg:"pan_object.cc_exp_month"};if(4!=b.cc_exp_year.length||isNaN(b.cc_exp_year))return{isValid:!1,statusMsg:"pan_object.cc_exp_year"};if(b.saveCard&&1!=b.saveCard.length)return{isValid:!1,statusMsg:"pan_object.saveCard"}}else if("ECHECK"==b.pan_type){if(0==b.bank_acct_no.length||19<b.bank_acct_no.length||isNaN(b.bank_acct_no))return{isValid:!1,statusMsg:"pan_object.bank_acct_no"};if(0==b.bank_routing_no.length||9<b.bank_routing_no.length||isNaN(b.bank_routing_no))return{isValid:!1,
statusMsg:"pan_object.bank_routing_no"};if(0==b.check_no.length||7<b.check_no.length||isNaN(b.check_no))return{isValid:!1,statusMsg:"pan_object.check_no"};if(33<b.driver_license_no.length||0==/^[a-zA-Z0-9]*$/.test(b.driver_license_no)||0==b.driver_license_no.length)return{isValid:!1,statusMsg:"pan_object.driver_license_no"}}else{if(19<b.bank_acct_no.length||isNaN(b.bank_acct_no||0==b.bank_acct_no.length))return{isValid:!1,statusMsg:"pan_object.bank_acct_no"};if(9<b.bank_routing_no.length||isNaN(b.bank_routing_no)||
0==b.bank_routing_no.length)return{isValid:!1,statusMsg:"pan_object.bank_routing_no"}}return{isValid:!0,statusMsg:"valid"}}function g(){c.fname=c.fname.trim();c.lname=c.lname.trim();c.zip=c.zip.trim();if(50<c.fname.length||0==/^[a-zA-Z0-9 '-\u00e0\u00e8\u00ec\u00f2\u00f9\u00c0\u00c8\u00cc\u00d2\u00d9\u00e1\u00e9\u00ed\u00f3\u00fa\u00fd\u00c1\u00c9\u00cd\u00d3\u00da\u00dd\u00e2\u00ea\u00ee\u00f4\u00fb\u00c2\u00ca\u00ce\u00d4\u00db\u00e3\u00f1\u00f5\u00c3\u00d1\u00d5\u00e4\u00eb\u00ef\u00f6\u00fc\u00ff\u00c4\u00cb\u00cf\u00d6\u00dc\u0178\u00e7\u00c7\u00df\u00d8\u00f8\u00c5\u00e5\u00c6\u00e6\u0153]*$/.test(c.fname)||
0==c.fname.length||""==c.fname)return{isValid:!1,statusMsg:"billing_contact.fname"};if(50<c.lname.length||0==/^[a-zA-Z0-9 '-\u00e0\u00e8\u00ec\u00f2\u00f9\u00c0\u00c8\u00cc\u00d2\u00d9\u00e1\u00e9\u00ed\u00f3\u00fa\u00fd\u00c1\u00c9\u00cd\u00d3\u00da\u00dd\u00e2\u00ea\u00ee\u00f4\u00fb\u00c2\u00ca\u00ce\u00d4\u00db\u00e3\u00f1\u00f5\u00c3\u00d1\u00d5\u00e4\u00eb\u00ef\u00f6\u00fc\u00ff\u00c4\u00cb\u00cf\u00d6\u00dc\u0178\u00e7\u00c7\u00df\u00d8\u00f8\u00c5\u00e5\u00c6\u00e6\u0153]*$/.test(c.lname)||
0==c.lname.length||""==c.lname)return{isValid:!1,statusMsg:"billing_contact.lname"};if(c.country&&("MX"==c.country.toUpperCase()||"CO"==c.country.toUpperCase())){if(0<c.zip.length&&(10<c.zip.length||0==/^[a-zA-Z0-9 -]*$/.test(c.zip)))return{isValid:!1,statusMsg:"billing_contact.zip"}}else if(0==c.zip.length||10<c.zip.length||0==/^[a-zA-Z0-9 -]*$/.test(c.zip))return{isValid:!1,statusMsg:"billing_contact.zip"};if("ECHECK"==b.pan_type){if(c.mname&&(15<c.mname.length||0==/^[a-zA-Z0-9 '-\u00e0\u00e8\u00ec\u00f2\u00f9\u00c0\u00c8\u00cc\u00d2\u00d9\u00e1\u00e9\u00ed\u00f3\u00fa\u00fd\u00c1\u00c9\u00cd\u00d3\u00da\u00dd\u00e2\u00ea\u00ee\u00f4\u00fb\u00c2\u00ca\u00ce\u00d4\u00db\u00e3\u00f1\u00f5\u00c3\u00d1\u00d5\u00e4\u00eb\u00ef\u00f6\u00fc\u00ff\u00c4\u00cb\u00cf\u00d6\u00dc\u0178\u00e7\u00c7\u00df\u00d8\u00f8\u00c5\u00e5\u00c6\u00e6\u0153]*$/.test(c.mname)))return{isValid:!1,
statusMsg:"billing_contact.mname"};if(100<c.addr1.length||0==c.addr1.length)return{isValid:!1,statusMsg:"billing_contact.addr1"};if(c.addr2&&100<c.addr2.length)return{isValid:!1,statusMsg:"billing_contact.addr2"};if(50<c.city.length||0==c.city.length)return{isValid:!1,statusMsg:"billing_contact.city"};if(15<c.state.length||0==c.state.length)return{isValid:!1,statusMsg:"billing_contact.state"};if(c.country&&2<c.country.length)return{isValid:!1,statusMsg:"billing_contact.country"};if(c.phone&&16<c.phone.length)return{isValid:!1,
statusMsg:"billing_contact.phone"};if(0==c.email.length)return{isValid:!1,statusMsg:"billing_contact.email"}}return{isValid:!0,statusMsg:"valid"}}try{if(void 0===a||null==a)return{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted, Invalid Inputs Caught in UI JS library, please check input 'basic_params' value."};if(void 0===b||null==b)return{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted, Invalid Inputs Caught in UI JS library, please check input 'pan_object' value."};
if(void 0===c||null==c)return{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted, Invalid Inputs Caught in UI JS library, please check input 'billing_contact' value."};if(void 0===d||null==d)return{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted, Invalid Inputs Caught in UI JS library, please check input 'successFn' value."};if(void 0===e||null==e)return{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted, Invalid Inputs Caught in UI JS library, please check input 'errorFn' value."};
var h=0==a.encryption_key.length||512<a.encryption_key.length||0==/^[a-zA-Z0-9]*$/.test(a.encryption_key)?{isValid:!1,statusMsg:"basic_params.encryption_key"}:0==a.url.length?{isValid:!1,statusMsg:"basic_params.url"}:33!=a.security_token.length||0==/^[a-zA-Z0-9]*$/.test(a.security_token)?{isValid:!1,statusMsg:"basic_params.security_token"}:0==a.appName.length?{isValid:!1,statusMsg:"basic_params.appName"}:{isValid:!0,statusMsg:"valid"};if(0==h.isValid)return{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted, Invalid Inputs Caught in UI JS library, please check input '"+
h.statusMsg+"' value."};var l=f();if(0==l.isValid)return{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted, Invalid Inputs Caught in UI JS library, please check input '"+l.statusMsg+"' value."};var k=g();if(0==k.isValid)return{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted, Invalid Inputs Caught in UI JS library, please check input '"+k.statusMsg+"' value."};var p=do_encrypt_encodePANData(b,a.encryption_key);if(null!=p){var m="?appName="+encodeURIComponent(a.appName).nullToString()+
"&security_token="+encodeURIComponent(a.security_token).nullToString()+"&pan_type="+encodeURIComponent(b.pan_type).nullToString()+"&encrypted_pan_data="+encodeURIComponent(p).nullToString()+"&exp_month="+encodeURIComponent(b.cc_exp_month).nullToString()+"&exp_year="+encodeURIComponent(b.cc_exp_year).nullToString()+"&fname="+encodeURIComponent(c.fname).nullToString()+"&mname="+encodeURIComponent(c.mname).nullToString()+"&lname="+encodeURIComponent(c.lname).nullToString()+"&addr1="+encodeURIComponent(c.addr1).nullToString()+
"&addr2="+encodeURIComponent(c.addr2).nullToString()+"&city="+(encodeURIComponent(c.city).nullToString()+"&state="+encodeURIComponent(c.state).nullToString()+"&zip="+encodeURIComponent(c.zip)).nullToString()+"&country="+encodeURIComponent(c.country).nullToString()+"&phone="+encodeURIComponent(c.phone).nullToString()+"&email="+encodeURIComponent(c.email).nullToString()+"&saveCard="+encodeURIComponent(b.saveCard).nullToString();jQuery.ajax({url:a.url+m,type:"POST",contentType:"text/plain",dataType:"text",
crossDomain:!0,async:!0,success:d,error:e});return{rtn_code:"BG-0",rtn_msg:"AJAX Request has been Submitted successfully."}}return{rtn_code:"BG-1065",rtn_msg:"AJAX Request hasn't been Submitted, Encryption Failed in UI JS library, please check 'encryption_key' value."}}catch(q){return{rtn_code:"BG-2222",rtn_msg:"AJAX Request hasn't been Submitted, please check inputs, Unexpected Error Occurred in JS lib. The Error message:"+q.message}}}
function do_encrypt(a,b,c){var d=new RSAKey;d.setPublic(c,"10001");return(a=d.encrypt("cc_no="+a+"&cvv="+b))?linebrk(hex2b64(a),64):null}
function do_encrypt_encodePANData(a,b){var c=new RSAKey,d;c.setPublic(b,"10001");"CC"==a.pan_type&&a.cc_no&&a.cvv?d=c.encrypt("cc_no="+a.cc_no+"&cvv="+a.cvv):"DD"==a.pan_type&&a.bank_acct_no&&a.bank_routing_no?d=c.encrypt("bank_acct_no="+a.bank_acct_no+"&bank_routing_no="+a.bank_routing_no):"ECHECK"==a.pan_type&&a.bank_acct_no&&a.bank_routing_no&&a.check_no&&a.driver_license_no&&(d=c.encrypt("bank_acct_no="+a.bank_acct_no+"&bank_routing_no="+a.bank_routing_no+"&check_no="+a.check_no+"&driver_license_no="+
a.driver_license_no));return d?linebrk(hex2b64(d),64):null}
function validate_ccNo(a,b,c){try{var d=b.split("|");for(b=0;b<d.length;b++)switch(d[b].trim().toUpperCase()){case "VISA":if(1==/^4\d{15}$/.test(a)&&0==applyLuhn(a)%10)return{isValid:!0,statusMsg:"Valid cc_no"};break;case "CRTBL":if(1==/^4\d{15}$/.test(a)&&0==applyLuhn(a)%10)return{isValid:!0,statusMsg:"Valid cc_no"};break;case "MASTER":if(1==/^(5[1-5]\d{14}|222[1-8]\d{12}|2229[0-8]\d{11}|22299\d{11}|22[3-9]\d{13}|2[3-6]\d{14}|27[01]\d{13}|2720[0-8]\d{11}|27209\d{11})$/.test(a)&&0==applyLuhn(a)%10)return{isValid:!0,
statusMsg:"Valid cc_no"};break;case "JCB":if(1==/^(2131|1800|35\d{3})\d{11}$/.test(a)&&0==applyLuhn(a)%10)return{isValid:!0,statusMsg:"Valid cc_no"};break;case "DISC":if(1==/^6011\d{12}$/.test(a)&&0==applyLuhn(a)%10)return{isValid:!0,statusMsg:"Valid cc_no"};break;case "AMEX":if(1==/^3[4-7]\d{13}$/.test(a)&&0==applyLuhn(a)%10)return{isValid:!0,statusMsg:"Valid cc_no"};break;default:return{isValid:!1,statusMsg:"Invalid card_types"}}return{isValid:!1,statusMsg:"Invalid cc_no"}}catch(e){return{isValid:!1,
statusMsg:"Invalid cc_no, Unexpected Error:"+e.message}}}
function validateInputs(a,b,c,d,e,f,g,h,l,k,p){return 33!=a.length||0==/^[a-zA-Z0-9]*$/.test(a)?{valid:!1,statusMsg:"security_token"}:40<h.length||0==/^[a-zA-Z0-9 '-\u00e0\u00e8\u00ec\u00f2\u00f9\u00c0\u00c8\u00cc\u00d2\u00d9\u00e1\u00e9\u00ed\u00f3\u00fa\u00fd\u00c1\u00c9\u00cd\u00d3\u00da\u00dd\u00e2\u00ea\u00ee\u00f4\u00fb\u00c2\u00ca\u00ce\u00d4\u00db\u00e3\u00f1\u00f5\u00c3\u00d1\u00d5\u00e4\u00eb\u00ef\u00f6\u00fc\u00ff\u00c4\u00cb\u00cf\u00d6\u00dc\u0178\u00e7\u00c7\u00df\u00d8\u00f8\u00c5\u00e5\u00c6\u00e6\u0153]*$/.test(h)||0>=
h.length?{valid:!1,statusMsg:"cc_fname"}:40<l.length||0==/^[a-zA-Z0-9 '-\u00e0\u00e8\u00ec\u00f2\u00f9\u00c0\u00c8\u00cc\u00d2\u00d9\u00e1\u00e9\u00ed\u00f3\u00fa\u00fd\u00c1\u00c9\u00cd\u00d3\u00da\u00dd\u00e2\u00ea\u00ee\u00f4\u00fb\u00c2\u00ca\u00ce\u00d4\u00db\u00e3\u00f1\u00f5\u00c3\u00d1\u00d5\u00e4\u00eb\u00ef\u00f6\u00fc\u00ff\u00c4\u00cb\u00cf\u00d6\u00dc\u0178\u00e7\u00c7\u00df\u00d8\u00f8\u00c5\u00e5\u00c6\u00e6\u0153]*$/.test(l)||0>=l.length?{valid:!1,statusMsg:"cc_lname"}:0==b.length||
19<b.length||isNaN(b)?{valid:!1,statusMsg:"cc_no"}:0!=applyLuhn(b)%10?{valid:!1,statusMsg:"cc_no(Failed Luhn Check)"}:3>c.length||4<c.length||isNaN(c)?{valid:!1,statusMsg:"cvv"}:0>=d||12<d||isNaN(d)?{valid:!1,statusMsg:"exp_month"}:4!=e.length||isNaN(e)?{valid:!1,statusMsg:"exp_year"}:0==f.length?{valid:!1,statusMsg:"appName"}:0==g.length||10<g.length||0==/^[a-zA-Z0-9 -]*$/.test(g)?{valid:!1,statusMsg:"zip"}:0==k.length||512<k.length||0==/^[a-zA-Z0-9]*$/.test(k)?{valid:!1,statusMsg:"key"}:0==p.length?
{valid:!1,statusMsg:"url"}:{valid:!0,statusMsg:"success"}}function applyLuhn(a){a=reverse(a).split("");for(var b=0,c=0,d=0;d<a.length;d++)0<d%2?(c=2*a[d],c=9>c?c:c-9,b+=c):b+=Number(a[d]);return b}function reverse(a){a=a.split("");for(var b="",c=a.length-1;0<=c;c--)b+=a[c];return b}var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64padchar="=";
function hex2b64(a){var b,c="";for(b=0;b+3<=a.length;b+=3){var d=parseInt(a.substring(b,b+3),16);c+=b64map.charAt(d>>6)+b64map.charAt(d&63)}for(b+1==a.length?(d=parseInt(a.substring(b,b+1),16),c+=b64map.charAt(d<<2)):b+2==a.length&&(d=parseInt(a.substring(b,b+2),16),c+=b64map.charAt(d>>2)+b64map.charAt((d&3)<<4));0<(c.length&3);)c+=b64padchar;return c}
function b64tohex(a){var b="",c,d=0,e;for(c=0;c<a.length&&a.charAt(c)!=b64padchar;++c)v=b64map.indexOf(a.charAt(c)),0>v||(0==d?(b+=int2char(v>>2),e=v&3,d=1):1==d?(b+=int2char(e<<2|v>>4),e=v&15,d=2):2==d?(b+=int2char(e),b+=int2char(v>>2),e=v&3,d=3):(b+=int2char(e<<2|v>>4),b+=int2char(v&15),d=0));1==d&&(b+=int2char(e<<2));return b}function b64toBA(a){a=b64tohex(a);var b,c=[];for(b=0;2*b<a.length;++b)c[b]=parseInt(a.substring(2*b,2*b+2),16);return c}
var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(canary&16777215);function BigInteger(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function nbi(){return new BigInteger(null)}function am1(a,b,c,d,e,f){for(;0<=--f;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864);c[d++]=g&67108863}return e}
function am2(a,b,c,d,e,f){var g=b&32767;for(b>>=15;0<=--f;){var h=this[a]&32767,l=this[a++]>>15,k=b*h+l*g;h=g*h+((k&32767)<<15)+c[d]+(e&1073741823);e=(h>>>30)+(k>>>15)+b*l+(e>>>30);c[d++]=h&1073741823}return e}function am3(a,b,c,d,e,f){var g=b&16383;for(b>>=14;0<=--f;){var h=this[a]&16383,l=this[a++]>>14,k=b*h+l*g;h=g*h+((k&16383)<<14)+c[d]+e;e=(h>>28)+(k>>14)+b*l;c[d++]=h&268435455}return e}
j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28);BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[],rr,vv;
rr=48;for(vv=0;9>=vv;++vv)BI_RC[rr++]=vv;rr=97;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;rr=65;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;function int2char(a){return BI_RM.charAt(a)}function intAt(a,b){var c=BI_RC[a.charCodeAt(b)];return null==c?-1:c}function bnpCopyTo(a){for(var b=this.t-1;0<=b;--b)a[b]=this[b];a.t=this.t;a.s=this.s}function bnpFromInt(a){this.t=1;this.s=0>a?-1:0;0<a?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0}function nbv(a){var b=nbi();b.fromInt(a);return b}
function bnpFromString(a,b){if(16==b)var c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else if(4==b)c=2;else{this.fromRadix(a,b);return}this.s=this.t=0;for(var d=a.length,e=!1,f=0;0<=--d;){var g=8==c?a[d]&255:intAt(a,d);0>g?"-"==a.charAt(d)&&(e=!0):(e=!1,0==f?this[this.t++]=g:f+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this[this.t++]=g>>this.DB-f):this[this.t-1]|=g<<f,f+=c,f>=this.DB&&(f-=this.DB))}8==c&&0!=(a[0]&128)&&(this.s=-1,0<f&&(this[this.t-1]|=(1<<this.DB-
f)-1<<f));this.clamp();e&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t}
function bnToString(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else if(4==a)a=2;else return this.toRadix(a);var b=(1<<a)-1,c,d=!1,e="",f=this.t,g=this.DB-f*this.DB%a;if(0<f--)for(g<this.DB&&0<(c=this[f]>>g)&&(d=!0,e=int2char(c));0<=f;)g<a?(c=(this[f]&(1<<g)-1)<<a-g,c|=this[--f]>>(g+=this.DB-a)):(c=this[f]>>(g-=a)&b,0>=g&&(g+=this.DB,--f)),0<c&&(d=!0),d&&(e+=int2char(c));return d?e:"0"}
function bnNegate(){var a=nbi();BigInteger.ZERO.subTo(this,a);return a}function bnAbs(){return 0>this.s?this.negate():this}function bnCompareTo(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;b=c-a.t;if(0!=b)return 0>this.s?-b:b;for(;0<=--c;)if(0!=(b=this[c]-a[c]))return b;return 0}function nbits(a){var b=1,c;0!=(c=a>>>16)&&(a=c,b+=16);0!=(c=a>>8)&&(a=c,b+=8);0!=(c=a>>4)&&(a=c,b+=4);0!=(c=a>>2)&&(a=c,b+=2);0!=a>>1&&(b+=1);return b}
function bnBitLength(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(a,b){var c;for(c=this.t-1;0<=c;--c)b[c+a]=this[c];for(c=a-1;0<=c;--c)b[c]=0;b.t=this.t+a;b.s=this.s}function bnpDRShiftTo(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0);b.s=this.s}
function bnpLShiftTo(a,b){var c=a%this.DB,d=this.DB-c,e=(1<<d)-1,f=Math.floor(a/this.DB),g=this.s<<c&this.DM,h;for(h=this.t-1;0<=h;--h)b[h+f+1]=this[h]>>d|g,g=(this[h]&e)<<c;for(h=f-1;0<=h;--h)b[h]=0;b[f]=g;b.t=this.t+f+1;b.s=this.s;b.clamp()}
function bnpRShiftTo(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)b.t=0;else{var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;0<d&&(b[this.t-c-1]|=(this.s&f)<<e);b.t=this.t-c;b.clamp()}}
function bnpSubTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0;-1>d?b[c++]=this.DV+d:0<d&&(b[c++]=d);b.t=c;b.clamp()}
function bnpMultiplyTo(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;0<=--e;)b[e]=0;for(e=0;e<d.t;++e)b[e+c.t]=c.am(0,d[e],b,e,0,c.t);b.s=0;b.clamp();this.s!=a.s&&BigInteger.ZERO.subTo(b,b)}function bnpSquareTo(a){for(var b=this.abs(),c=a.t=2*b.t;0<=--c;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}0<a.t&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1));a.s=0;a.clamp()}
function bnpDivRemTo(a,b,c){var d=a.abs();if(!(0>=d.t)){var e=this.abs();if(e.t<d.t)null!=b&&b.fromInt(0),null!=c&&this.copyTo(c);else{null==c&&(c=nbi());var f=nbi(),g=this.s;a=a.s;var h=this.DB-nbits(d[d.t-1]);0<h?(d.lShiftTo(h,f),e.lShiftTo(h,c)):(d.copyTo(f),e.copyTo(c));d=f.t;e=f[d-1];if(0!=e){var l=e*(1<<this.F1)+(1<d?f[d-2]>>this.F2:0),k=this.FV/l;l=(1<<this.F1)/l;var p=1<<this.F2,m=c.t,q=m-d,n=null==b?nbi():b;f.dlShiftTo(q,n);0<=c.compareTo(n)&&(c[c.t++]=1,c.subTo(n,c));BigInteger.ONE.dlShiftTo(d,
n);for(n.subTo(f,f);f.t<d;)f[f.t++]=0;for(;0<=--q;){var r=c[--m]==e?this.DM:Math.floor(c[m]*k+(c[m-1]+p)*l);if((c[m]+=f.am(0,r,c,q,0,d))<r)for(f.dlShiftTo(q,n),c.subTo(n,c);c[m]<--r;)c.subTo(n,c)}null!=b&&(c.drShiftTo(d,b),g!=a&&BigInteger.ZERO.subTo(b,b));c.t=d;c.clamp();0<h&&c.rShiftTo(h,c);0>g&&BigInteger.ZERO.subTo(c,c)}}}}function bnMod(a){var b=nbi();this.abs().divRemTo(a,null,b);0>this.s&&0<b.compareTo(BigInteger.ZERO)&&a.subTo(b,b);return b}function Classic(a){this.m=a}
function cConvert(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}function cSqrTo(a,b){a.squareTo(b);this.reduce(b)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;
function bnpInvDigit(){if(1>this.t)return 0;var a=this[0];if(0==(a&1))return 0;var b=a&3;b=b*(2-(a&15)*b)&15;b=b*(2-(a&255)*b)&255;b=b*(2-((a&65535)*b&65535))&65535;b=b*(2-a*b%this.DV)%this.DV;return 0<b?this.DV-b:-b}function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}
function montConvert(a){var b=nbi();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);0>a.s&&0<b.compareTo(BigInteger.ZERO)&&this.m.subTo(b,b);return b}function montRevert(a){var b=nbi();a.copyTo(b);this.reduce(b);return b}
function montReduce(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=a[b]&32767,d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;c=b+this.m.t;for(a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)}function montSqrTo(a,b){a.squareTo(b);this.reduce(b)}function montMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}Montgomery.prototype.convert=montConvert;
Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return 0==(0<this.t?this[0]&1:this.s)}function bnpExp(a,b){if(4294967295<a||1>a)return BigInteger.ONE;var c=nbi(),d=nbi(),e=b.convert(this),f=nbits(a)-1;for(e.copyTo(c);0<=--f;)if(b.sqrTo(c,d),0<(a&1<<f))b.mulTo(d,e,c);else{var g=c;c=d;d=g}return b.revert(c)}
function bnModPowInt(a,b){var c=256>a||b.isEven()?new Classic(b):new Montgomery(b);return this.exp(a,c)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;
BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;
BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function Arcfour(){this.j=this.i=0;this.S=[]}function ARC4init(a){var b,c;for(b=0;256>b;++b)this.S[b]=b;for(b=c=0;256>b;++b){c=c+this.S[b]+a[b%a.length]&255;var d=this.S[b];this.S[b]=this.S[c];this.S[c]=d}this.j=this.i=0}function ARC4next(){this.i=this.i+1&255;this.j=this.j+this.S[this.i]&255;var a=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=a;return this.S[a+this.S[this.i]&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;
function prng_newstate(){return new Arcfour}var rng_psize=256,rng_state,rng_pool,rng_pptr;function rng_seed_int(a){rng_pool[rng_pptr++]^=a&255;rng_pool[rng_pptr++]^=a>>8&255;rng_pool[rng_pptr++]^=a>>16&255;rng_pool[rng_pptr++]^=a>>24&255;rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}
if(null==rng_pool){rng_pool=[];rng_pptr=0;var t;if(window.crypto&&window.crypto.getRandomValues){var ua=new Uint8Array(32);window.crypto.getRandomValues(ua);for(t=0;32>t;++t)rng_pool[rng_pptr++]=ua[t]}if("Netscape"==navigator.appName&&"5">navigator.appVersion&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=z.charCodeAt(t)&255}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=t&255;rng_pptr=0;rng_seed_time()}
function rng_get_byte(){if(null==rng_state){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(a){var b;for(b=0;b<a.length;++b)a[b]=rng_get_byte()}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function parseBigInt(a,b){return new BigInteger(a,b)}
function linebrk(a,b){for(var c="",d=0;d+b<a.length;)c+=a.substring(d,d+b)+"\n",d+=b;return c+a.substring(d,a.length)}function byte2Hex(a){return 16>a?"0"+a.toString(16):a.toString(16)}
function pkcs1pad2(a,b){if(b<a.length+11)return alert("Message too long for RSA"),null;for(var c=[],d=a.length-1;0<=d&&0<b;){var e=a.charCodeAt(d--);128>e?c[--b]=e:127<e&&2048>e?(c[--b]=e&63|128,c[--b]=e>>6|192):(c[--b]=e&63|128,c[--b]=e>>6&63|128,c[--b]=e>>12|224)}c[--b]=0;d=new SecureRandom;for(e=[];2<b;){for(e[0]=0;0==e[0];)d.nextBytes(e);c[--b]=e[0]}c[--b]=2;c[--b]=0;return new BigInteger(c)}function RSAKey(){this.n=null;this.e=0;this.coeff=this.dmq1=this.dmp1=this.q=this.p=this.d=null}
function RSASetPublic(a,b){null!=a&&null!=b&&0<a.length&&0<b.length?(this.n=parseBigInt(a,16),this.e=parseInt(b,16)):alert("Invalid RSA public key")}function RSADoPublic(a){return a.modPowInt(this.e,this.n)}function RSAEncrypt(a){a=pkcs1pad2(a,this.n.bitLength()+7>>3);if(null==a)return null;a=this.doPublic(a);if(null==a)return null;a=a.toString(16);return 0==(a.length&1)?a:"0"+a}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;